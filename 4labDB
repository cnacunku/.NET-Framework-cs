SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- Таблица Поручение
CREATE TABLE `Поручение` (
  `iD_пор` BIGINT NOT NULL,
  `Название поручения` VARCHAR(30) NULL,
  `Содержание` TEXT NULL,
  `Дата выдачи` DATE NULL,
  `Срок исполнения` DATETIME NULL,
  `Дата фактического исполнения` DATE NULL,
  `iD_рук` BIGINT NOT NULL,
  `iD_кат` BIGINT NOT NULL,
  `iD_статус` BIGINT NOT NULL,
  `iD_приор` BIGINT NOT NULL,
  PRIMARY KEY (`iD_пор`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE INDEX `IX_Relationship3` ON `Поручение` (`iD_рук`);
CREATE INDEX `IX_Relationship6` ON `Поручение` (`iD_кат`);
CREATE INDEX `IX_Relationship7` ON `Поручение` (`iD_статус`);
CREATE INDEX `IX_Relationship8` ON `Поручение` (`iD_приор`);

-- Таблица Категория
CREATE TABLE `Категория` (
  `iD_кат` BIGINT NOT NULL,
  `Название` VARCHAR(30) NULL,
  `Описание` TEXT NULL,
  PRIMARY KEY (`iD_кат`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Таблица Статус
CREATE TABLE `Статус` (
  `iD_статус` BIGINT NOT NULL,
  `Название` VARCHAR(30) NULL,
  `Описание` TEXT NULL,
  PRIMARY KEY (`iD_статус`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Таблица Приоритет
CREATE TABLE `Приоритет` (
  `iD_приор` BIGINT NOT NULL,
  `Название` VARCHAR(30) NULL,
  `Описание` TEXT NULL,
  PRIMARY KEY (`iD_приор`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Таблица Руководитель
CREATE TABLE `Руководитель` (
  `iD_рук` BIGINT NOT NULL,
  `Фамилия` VARCHAR(30) NULL,
  `Имя` VARCHAR(20) NULL,
  `Отчество` VARCHAR(30) NULL,
  `Должность` VARCHAR(30) NULL,
  `Телефон` BIGINT NULL,
  `email` VARCHAR(30) NULL,
  `iD_под` BIGINT NOT NULL,
  PRIMARY KEY (`iD_рук`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE INDEX `IX_Relationship1` ON `Руководитель` (`iD_под`);

-- Таблица Исполнитель
CREATE TABLE `Исполнитель` (
  `iD_исп` BIGINT NOT NULL,
  `Фамилия` VARCHAR(30) NULL,
  `Имя` VARCHAR(20) NULL,
  `Отчество` VARCHAR(30) NULL,
  `Должность` VARCHAR(30) NULL,
  `Телефон` BIGINT NULL,
  `email` VARCHAR(30) NULL,
  `iD_под` BIGINT NOT NULL,
  PRIMARY KEY (`iD_исп`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE INDEX `IX_Relationship2` ON `Исполнитель` (`iD_под`);

-- Таблица Подразделение
CREATE TABLE `Подразделение` (
  `iD_под` BIGINT NOT NULL,
  `Название` VARCHAR(30) NULL,
  `Местоположение` VARCHAR(80) NULL,
  `Телефон` BIGINT NULL,
  PRIMARY KEY (`iD_под`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Таблица Исполнитель_Поручение
CREATE TABLE `Исполнитель_Поручение` (
  `iD_исп` BIGINT NOT NULL,
  `iD_пор` BIGINT NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- FOREIGN KEYS ----------------------------------------------

ALTER TABLE `Руководитель`
  ADD CONSTRAINT `Relationship1`
  FOREIGN KEY (`iD_под`) REFERENCES `Подразделение` (`iD_под`)
  ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE `Исполнитель`
  ADD CONSTRAINT `Relationship2`
  FOREIGN KEY (`iD_под`) REFERENCES `Подразделение` (`iD_под`)
  ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE `Поручение`
  ADD CONSTRAINT `Relationship3`
  FOREIGN KEY (`iD_рук`) REFERENCES `Руководитель` (`iD_рук`)
  ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE `Поручение`
  ADD CONSTRAINT `Relationship6`
  FOREIGN KEY (`iD_кат`) REFERENCES `Категория` (`iD_кат`)
  ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE `Поручение`
  ADD CONSTRAINT `Relationship7`
  FOREIGN KEY (`iD_статус`) REFERENCES `Статус` (`iD_статус`)
  ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE `Поручение`
  ADD CONSTRAINT `Relationship8`
  FOREIGN KEY (`iD_приор`) REFERENCES `Приоритет` (`iD_приор`)
  ON UPDATE NO ACTION ON DELETE NO ACTION;

SET FOREIGN_KEY_CHECKS = 1;
